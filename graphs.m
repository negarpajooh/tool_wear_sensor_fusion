clc;
clear;
close all;
format long
%%
xy=[0.86747	0.736123
6.07229	0.73594
10.4096	0.748479
14.747	0.773711
18.2169	0.798973
21.6867	0.824235
24.2892	0.849528
26.8916	0.874821
29.494	0.912806
31.2289	0.950822
33.8313	0.988807
34.6988	1.01416
36.4337	1.05218
38.1687	1.09019
39.9036	1.1409
41.6386	1.2043
43.3735	1.24232
45.1084	1.29303
45.9759	1.34376
47.7108	1.38178
48.5783	1.41983
49.4458	1.47056
50.3133	1.5213
52.0482	1.57201
52.9157	1.63544
54.6506	1.69884
55.5181	1.76227
57.253	1.80029
58.1205	1.86372
58.988	1.91446
60.7229	1.97786
61.5904	2.0286
62.4578	2.09203
63.3253	2.14277
65.0602	2.21886
65.9277	2.29498
67.6627	2.34569
69.3976	2.40909
70.2651	2.48522
71.1325	2.54865
72.8675	2.59935
74.6024	2.66275
76.3373	2.71346
77.2048	2.77689
78.0723	2.84032
80.6747	2.891
81.5422	2.95443
83.2771	3.00514
85.8795	3.04313
87.6145	3.08114
91.0843	3.1064
94.5542	3.10628
96.2892	3.08084
98.0241	3.0427
98.8916	3.01728
100.627	2.97914
101.494	2.92834
103.229	2.89021
104.964	2.83938
105.831	2.80127
106.699	2.75047
107.566	2.69967
108.434	2.66156
109.301	2.61076
111.036	2.54724
111.904	2.49644
111.904	2.43298
113.639	2.36946
115.373	2.30593
115.373	2.24247
117.108	2.16626
118.843	2.09004
120.578	2.00113
121.446	1.91226
122.313	1.83607
123.181	1.77258
125.783	1.68364
126.651	1.60746
127.518	1.53127
128.386	1.46778
130.12	1.40426
130.988	1.32807
130.988	1.2773
132.723	1.21378
133.59	1.16298
134.458	1.11218
136.193	1.04866
137.928	0.985137
139.663	0.921614
141.398	0.845399
143.133	0.794569
144.867	0.731046
146.602	0.680216
148.337	0.642078
150.072	0.60394
152.675	0.578463
156.145	0.552956
160.482	0.540111
163.952	0.552681
167.422	0.590636
172.627	0.641222
176.096	0.704561
179.566	0.755208
183.036	0.818547
186.506	0.856501
189.108	0.919871
192.578	0.970518
195.181	1.0085
197.783	1.07187
200.386	1.12255
202.988	1.17323
204.723	1.23663
206.458	1.27464
208.193	1.32535
209.928	1.36337
211.663	1.42677
213.398	1.46478
215.133	1.51549
216	1.57892
217.735	1.62963
218.602	1.69306
220.337	1.74377
221.205	1.8072
222.072	1.85794
223.807	1.90865
224.675	1.95939
225.542	1.99743
228.145	2.0608
229.012	2.12423
229.88	2.17497
230.747	2.2384
232.482	2.3018
234.217	2.3652
235.084	2.41594
236.819	2.46665
237.687	2.51739
238.554	2.56813
240.289	2.60614
242.024	2.65685
242.892	2.72028
245.494	2.77096
247.229	2.82167
248.964	2.87238
251.566	2.91036
252.434	2.93572
255.904	2.96098
258.506	2.94819
261.108	2.91003
263.711	2.87186
265.446	2.83372
267.181	2.7575
268.916	2.69398
270.651	2.64315
271.518	2.57966
272.386	2.54155
274.12	2.49072
274.988	2.42723
276.723	2.3764
277.59	2.31291
278.458	2.23672
279.325	2.17323
282.795	1.97003
283.663	1.91923
284.53	1.86843
285.398	1.74148
285.398	1.81763
287.133	1.69065
288	1.63985
288.867	1.60174
288.867	1.55097
289.735	1.48748
290.602	1.42399
291.47	1.36049
292.337	1.297
293.205	1.2462
294.94	1.18268
295.807	1.11919
296.675	1.06839
296.675	1.03031
298.41	0.966787
299.277	0.903295
301.012	0.839772
301.88	0.788972
302.747	0.750865
303.614	0.700065
305.349	0.611158
305.349	0.661927
307.084	0.573019
308.819	0.534881
311.422	0.471328
314.024	0.433159
316.627	0.382298
319.229	0.34413];
xy1=[292.627	0.440788
290.398	0.486461
288.165	0.516948
285.929	0.532248
284.446	0.577883
282.963	0.623518
282.226	0.669116
280.743	0.714751
279.263	0.775573
278.529	0.836357
277.046	0.881992
276.312	0.942776
275.578	1.00356
274.838	1.03397
274.101	1.07957
273.364	1.12517
272.627	1.17076
271.89	1.21636
271.156	1.27714
270.422	1.33793
268.957	1.47468
268.942	1.39875
267.477	1.53551
266.746	1.61148
266.013	1.67226
265.279	1.73304
264.548	1.80901
263.817	1.88499
262.349	2.00655
262.337	1.94581
261.619	2.08252
260.885	2.14331
260.148	2.18891
259.414	2.24969
258.68	2.31047
257.206	2.40167
255.735	2.50805
255.004	2.58402
254.274	2.65999
253.543	2.73596
252.812	2.81193
251.332	2.87275
250.598	2.93354
249.124	3.02473
248.397	3.11589
246.916	3.17671
245.439	3.25272
243.965	3.34392
242.482	3.38955
240.999	3.43519
239.513	3.46563
237.283	3.51131
234.298	3.51146
232.053	3.4812
230.554	3.4509
228.306	3.40546
226.804	3.35997
225.303	3.31449
224.544	3.25378
223.036	3.17792
221.531	3.11725
220.023	3.04139
218.512	2.95035
217.753	2.88964
216.245	2.81378
215.49	2.76826
214.728	2.69237
213.223	2.6317
213.211	2.57095
212.449	2.49505
210.947	2.44957
209.442	2.3889
209.427	2.31297
208.668	2.25226
207.91	2.19155
206.408	2.14607
204.903	2.08539
204.144	2.02469
203.389	1.97916
202.63	1.91846
201.125	1.85779
200.37	1.81226
199.611	1.75155
198.109	1.70607
197.354	1.66055
196.598	1.61503
195.096	1.56954
194.341	1.52402
192.839	1.47854
191.334	1.41787
189.832	1.37238
188.33	1.3269
186.082	1.28145
183.837	1.25119
181.592	1.22093
177.858	1.20593
174.87	1.1909
171.885	1.19105
169.643	1.17598
165.911	1.17617
162.923	1.16113
159.932	1.13091
158.43	1.08542
155.436	1.04002
153.185	0.979382
150.937	0.933936
148.686	0.873303
147.181	0.812632
145.679	0.767148
144.174	0.706478
142.666	0.63062
140.415	0.569987
138.157	0.478981
136.649	0.403124
135.144	0.342453
132.893	0.28182
131.391	0.236336
129.89	0.190852
127.642	0.145406
125.397	0.115146
123.898	0.0848483
121.659	0.0849617
119.423	0.100262
117.937	0.13071
116.451	0.161159
114.968	0.206794
113.481	0.237243
112.744	0.28284
111.258	0.313289
110.521	0.358886
109.784	0.404484
109.047	0.450081
108.31	0.495679
107.573	0.541276
106.833	0.571687
106.102	0.647658
105.365	0.693255
104.631	0.754039
103.151	0.814861
102.417	0.875645
101.687	0.951616
100.953	1.0124
100.219	1.07318
99.4911	1.16434
99.4818	1.11878
98.7542	1.20994
97.2802	1.30113
97.2709	1.25557
96.5433	1.34673
95.8218	1.46826
95.8094	1.40752
95.0848	1.51386
94.3478	1.55946
93.6232	1.6658
93.6139	1.62024
92.8863	1.7114
92.1524	1.77218
91.4154	1.81778
90.6815	1.87856
89.9508	1.95453
89.2262	2.06088
87.746	2.1217
87.0122	2.18248
86.2783	2.24327
85.5475	2.31924
84.8136	2.38002
83.3366	2.45603
82.6027	2.51681
81.8689	2.5776
81.1319	2.6232
79.6517	2.68402
78.1716	2.74484
77.4346	2.79044
76.7008	2.85122
74.4744	2.91208
72.9911	2.95772
72.2542	3.00331
71.511	3.01854
68.526	3.01869
65.5409	3.01884
63.2959	2.98858
61.7941	2.9431
59.5461	2.89765
58.7874	2.83694
56.5362	2.77631
55.0313	2.71564
54.2727	2.65493
52.7647	2.57907
52.006	2.51836
50.498	2.44251
48.9931	2.38184
48.2345	2.32113
46.7296	2.26046
45.2277	2.21497
43.7197	2.13911
42.958	2.06322
42.1994	2.00251
40.6913	1.92665
39.1864	1.86598
37.6815	1.80531
36.9229	1.7446
35.4211	1.69912
33.1699	1.63849
31.665	1.57782
29.4169	1.53237
27.1719	1.50211
24.927	1.47185
21.9419	1.472
18.9569	1.47215
16.7212	1.48745
13.7423	1.51798
10.7604	1.53331
9.27407	1.56376
7.04148	1.59425
4.06263	1.62477
0.334424	1.64015];
%%
% plot(xy(:,1),xy(:,2))
% cftool( xy(:,1), xy(:,2) )
% plot(xy1(:,1),xy1(:,2))
% cftool( xy1(:,1), xy1(:,2) )
%%
       a1 =      -1.333;  %(-102.4, 99.76)
       b1 =       86.08;  %(-1.928, 174.1)
       c1 =        29.8 ; %(-117.8, 177.4)
       a2 =      -1.579 ; %(-16.23, 13.07)
       b2 =       229.5;  %(190.8, 268.2)
       c2 =       29.62 ; %(-26.19, 85.44)
       a3 =       3.607 ; %(-96.94, 104.2)
       b3 =       89.14;  %(30.85, 147.4)
       c3 =       34.67 ; %(-54.3, 123.6)
       a4 =      0.8048;  %(0.3701, 1.24)
       b4 =       80.62 ; %(-34.99, 196.2)
       c4 =       229.7;  %(66.44, 392.9)
       a5 =     -0.1787;  %(-1.236, 0.8782)
       b5 =       244.6;  %(237.6, 251.6)
       c5 =       14.74;  %(-4.886, 34.36)
       a6 =      0.4405 ; %(-0.4568, 1.338)
       b6 =       281.2 ; %(274.4, 288.1)
       c6 =       18.63 ; %(8.569, 28.68)
       a7 =       3.669 ; %(-10.05, 17.39)
       b7 =       242.4 ; %(204.6, 280.2)
       c7 =       38.57;  %(30.14, 47.01)
       a8 =     -0.2901 ; %(-0.67, 0.0899)
       b8 =       151.5 ; %(124.6, 178.3)
       c8 =        24.5 ; %(7.129, 41.87)
%%
x=0:0.1:319.229;
x2=x;
fx=a1*exp(-((x-b1)/c1).^2) + a2*exp(-((x-b2)/c2).^2) +...
a3*exp(-((x-b3)/c3).^2) + a4*exp(-((x-b4)/c4).^2) +... 
a5*exp(-((x-b5)/c5).^2) + a6*exp(-((x-b6)/c6).^2) +... 
a7*exp(-((x-b7)/c7).^2) + a8*exp(-((x-b8)/c8).^2);
% figure
% plot(x,fx)
% grid minor
% xlabel('Sample Points')
% ylabel('Current - Amp')
%%
  a1 = 2.798  ;%(-2838, 2843)
       b1 =     0.01076 ; %(-5.453, 5.474)
       c1 =       0.108 ; %(-646, 646.2)
       a2 =       1.863;  %(-2554, 2557)
       b2 =     0.02125 ; %(-10.58, 10.62)
       c2 =       1.882 ; %(-1490, 1494)
       a3 =      0.7164 ; %(-242.7, 244.1)
       b3 =     0.04277 ; %(-4.358, 4.444)
       c3 =      -1.514 ; %(-755.7, 752.7)
       a4 =      0.4714;  %(-208.3, 209.3)
       b4 =     0.07232 ; %(-5.308, 5.453)
       c4 =      -3.352;  %(-859.6, 852.9)
       a5 =      0.1811;  %(-242, 242.3)
       b5 =     0.08474;  %(-8.897, 9.066)
       c5 =      0.9757 ; %(-1418, 1420)
       a6 =     0.03783;  %(-16.83, 16.91)
       b6 =      0.1008;  %(-1.391, 1.592)
       c6 =       1.225;  %(-360.9, 363.3)
       a7 =    0.005177;  %(-0.1808, 0.1912)
       b7 =      0.1338 ; %(-0.2255, 0.4931)
       c7 =      0.5388;  %(-52.56, 53.64)
       a8 =    0.003862 ; %(2.396e-05, 0.007701)
       b8 =      0.2488;  %(0.2353, 0.2623)
       c8 =      -2.791;  %(-4.98, -0.6021)
%%
x=0:.1:292.627;
x1=x;
   fx1= a1*sin(b1*x+c1) + a2*sin(b2*x+c2) + a3*sin(b3*x+c3) + ...
        a4*sin(b4*x+c4) + a5*sin(b5*x+c5) + a6*sin(b6*x+c6) + ...
        a7*sin(b7*x+c7) + a8*sin(b8*x+c8);
% figure
% plot(x1,fx1)
% grid minor
% xlabel('Sample Points')
% ylabel('Current - Amp')
%%
figure
plot(x2,fx)
hold on
plot(x1,fx1)
grid minor
xlabel('Sample Points')
ylabel('Current - A')
legend('sharp tool','worn tool')
%%
y1 = wgn(1000,1,0);
figure
plot(y1)
grid minor
xlabel('Time - s')
ylabel('Frequency - H z')

